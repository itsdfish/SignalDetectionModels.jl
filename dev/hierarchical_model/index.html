<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Hierarchical Model · SignalDetectionModels</title><meta name="title" content="Hierarchical Model · SignalDetectionModels"/><meta property="og:title" content="Hierarchical Model · SignalDetectionModels"/><meta property="twitter:title" content="Hierarchical Model · SignalDetectionModels"/><meta name="description" content="Documentation for SignalDetectionModels."/><meta property="og:description" content="Documentation for SignalDetectionModels."/><meta property="twitter:description" content="Documentation for SignalDetectionModels."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="https://fonts.googleapis.com/css?family=Montserrat|Source+Code+Pro&amp;display=swap" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">SignalDetectionModels</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../basic_usage/">Basic Usage</a></li><li><a class="tocitem" href="../plotting/">Plotting</a></li><li class="is-active"><a class="tocitem" href>Hierarchical Model</a><ul class="internal"><li class="toplevel"><a class="tocitem" href="#Load-Dependencies"><span>Load Dependencies</span></a></li><li class="toplevel"><a class="tocitem" href="#Model-Configuration"><span>Model Configuration</span></a></li><li class="toplevel"><a class="tocitem" href="#Generate-Subject-Level-Parameters"><span>Generate Subject-Level Parameters</span></a></li><li class="toplevel"><a class="tocitem" href="#Generate-Simulated-Data"><span>Generate Simulated Data</span></a></li><li class="toplevel"><a class="tocitem" href="#Estimate-Parameters"><span>Estimate Parameters</span></a></li><li class="toplevel"><a class="tocitem" href="#Plot-Group-Level-Posterior-Distributions"><span>Plot Group-Level Posterior Distributions</span></a></li></ul></li><li><a class="tocitem" href="../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Hierarchical Model</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Hierarchical Model</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/itsdfish/SignalDetectionModels.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/itsdfish/SignalDetectionModels.jl/blob/main/docs/src/hierarchical_model.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Overview"><a class="docs-heading-anchor" href="#Overview">Overview</a><a id="Overview-1"></a><a class="docs-heading-anchor-permalink" href="#Overview" title="Permalink"></a></h1><h3 id="Full-Code"><a class="docs-heading-anchor" href="#Full-Code">Full Code</a><a id="Full-Code-1"></a><a class="docs-heading-anchor-permalink" href="#Full-Code" title="Permalink"></a></h3><p>You can reveal copy-and-pastable version of the full code by clicking the ▶ below.</p><details>
<summary><b>Show Full Code</b></summary><pre><code class="language-julia hljs">using Distributions
using Mooncake
using Random
using SignalDetectionModels
using StatsPlots
using Turing 

Random.seed!(2185)
n_subj = 100
nₙ = 100

parms = map(1:n_subj) do _ 
    d = rand(Normal(0, 1))
    c = rand(Normal(0, 1))
    (;d, c, nₙ)
end

data = map(Θ -&gt; rand(SDT(; Θ...)), parms)

@model function turing_model(data, nₙ)
    n_subj = length(data)
    # mean of group-level discriminability  
    μd ~ Normal(0, 1)
    # SD of group-level discriminability 
    σd ~ Gamma(2, 1)
    d ~ filldist(Normal(μd, σd), n_subj)
    # mean of group-level criterion  
    μc ~ Normal(0, 1)
    # SD of group-level criterion 
    σc ~ Gamma(2, 1)
    c ~ filldist(Normal(μc, σc), n_subj)
    for i ∈ 1:n_subj
        data[i] ~ SDT(; d = d[i], c = c[i], nₙ)
    end
end

# adtype = AutoForwardDiff()
adtype = AutoMooncake()

chains = sample(turing_model(data, nₙ), NUTS(1000, 0.65; adtype), MCMCThreads(), 1000, 4)
group_chains = chains[:, [:μd, :μc, :σd, :σc],:]
describe(group_chains)
plot(group_chains)</code></pre></details><h1 id="Load-Dependencies"><a class="docs-heading-anchor" href="#Load-Dependencies">Load Dependencies</a><a id="Load-Dependencies-1"></a><a class="docs-heading-anchor-permalink" href="#Load-Dependencies" title="Permalink"></a></h1><pre><code class="language-julia hljs">using Distributions
using Mooncake
using Random
using SignalDetectionModels
using StatsPlots
using Turing</code></pre><h1 id="Model-Configuration"><a class="docs-heading-anchor" href="#Model-Configuration">Model Configuration</a><a id="Model-Configuration-1"></a><a class="docs-heading-anchor-permalink" href="#Model-Configuration" title="Permalink"></a></h1><pre><code class="language-julia hljs">Random.seed!(2185)
n_subj = 100
nₙ = 100</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">100</code></pre><h1 id="Generate-Subject-Level-Parameters"><a class="docs-heading-anchor" href="#Generate-Subject-Level-Parameters">Generate Subject-Level Parameters</a><a id="Generate-Subject-Level-Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Generate-Subject-Level-Parameters" title="Permalink"></a></h1><pre><code class="language-julia hljs">parms = map(1:n_subj) do _
    d = rand(Normal(0, 1))
    c = rand(Normal(0, 1))
    (;d, c, nₙ)
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">100-element Vector{@NamedTuple{d::Float64, c::Float64, nₙ::Int64}}:
 (d = -1.4630458513089526, c = -0.14664174435689137, nₙ = 100)
 (d = -0.6865167098380317, c = 1.2398511005662909, nₙ = 100)
 (d = 1.1781613189015416, c = 1.3114557448413826, nₙ = 100)
 (d = -1.5471743826551625, c = 0.06962972228648177, nₙ = 100)
 (d = -1.3978233882228488, c = -0.9364569991510396, nₙ = 100)
 (d = -0.05802943767222021, c = 0.13890045796270215, nₙ = 100)
 (d = 1.4190829728908616, c = -2.03767671749094, nₙ = 100)
 (d = -0.9728220659391172, c = 0.14363968532506352, nₙ = 100)
 (d = 0.6855894454113424, c = -1.414007657898611, nₙ = 100)
 (d = 0.06932596008055865, c = -0.4639933417337933, nₙ = 100)
 ⋮
 (d = 0.7335231360249478, c = 0.6963638482072578, nₙ = 100)
 (d = -0.13254918516057748, c = 0.2019342312285804, nₙ = 100)
 (d = 0.014668833060195131, c = 0.5469213014285694, nₙ = 100)
 (d = 1.179646486786501, c = 1.6100562408148893, nₙ = 100)
 (d = -0.22329483926020355, c = 0.44059457879904723, nₙ = 100)
 (d = 0.3072685496056652, c = -0.5672568994625429, nₙ = 100)
 (d = 0.10161567832080967, c = 0.7663582195496762, nₙ = 100)
 (d = -1.0328575647345128, c = 0.5460483349819097, nₙ = 100)
 (d = -1.001898015138495, c = -0.7917820054760446, nₙ = 100)</code></pre><h1 id="Generate-Simulated-Data"><a class="docs-heading-anchor" href="#Generate-Simulated-Data">Generate Simulated Data</a><a id="Generate-Simulated-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Generate-Simulated-Data" title="Permalink"></a></h1><pre><code class="language-julia hljs">@model function turing_model(data, nₙ)
    n_subj = length(data)
    # mean of group-level discriminability
    μd ~ Normal(0, 1)
    # SD of group-level discriminability
    σd ~ Gamma(2, 1)
    d ~ filldist(Normal(μd, σd), n_subj)
    # mean of group-level criterion
    μc ~ Normal(0, 1)
    # SD of group-level criterion
    σc ~ Gamma(2, 1)
    c ~ filldist(Normal(μc, σc), n_subj)
    for i ∈ 1:n_subj
        data[i] ~ SDT(; d = d[i], c = c[i], nₙ)
    end
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">turing_model (generic function with 2 methods)</code></pre><h1 id="Estimate-Parameters"><a class="docs-heading-anchor" href="#Estimate-Parameters">Estimate Parameters</a><a id="Estimate-Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Estimate-Parameters" title="Permalink"></a></h1><pre><code class="language-julia hljs">chains = sample(turing_model(data, nₙ), NUTS(1000, 0.65; adtype = AutoMooncake()), MCMCThreads(), 1000, 4)
group_chains = chains[:, [:μd, :μc, :σd, :σc],:]
describe(group_chains)</code></pre><pre><code class="language-julia hljs">
Chains MCMC chain (1000×4×4 Array{Float64, 3}):

Iterations        = 1001:1:2000
Number of chains  = 4
Samples per chain = 1000
Wall duration     = 17.12 seconds
Compute duration  = 54.87 seconds
parameters        = μd, σd, μc, σc
internals         = 

Summary Statistics

  parameters      mean       std      mcse    ess_bulk    ess_tail      rhat   ess_per_sec 
      Symbol   Float64   Float64   Float64     Float64     Float64   Float64       Float64 

          μd    0.1339    0.1090    0.0016   4488.5820   3268.4618    0.9995       81.8069
          σd    1.0701    0.0831    0.0013   4417.6982   3199.9839    0.9998       80.5150
          μc    0.1178    0.0977    0.0015   4449.0158   2827.2720    1.0014       81.0858
          σc    0.9674    0.0712    0.0011   4575.8835   3487.0255    1.0006       83.3980


Quantiles

  parameters      2.5%     25.0%     50.0%     75.0%     97.5% 
      Symbol   Float64   Float64   Float64   Float64   Float64 

          μd   -0.0753    0.0637    0.1346    0.2039    0.3544
          σd    0.9230    1.0112    1.0659    1.1219    1.2496
          μc   -0.0762    0.0530    0.1192    0.1822    0.3084
          σc    0.8428    0.9173    0.9626    1.0119    1.1205</code></pre><h1 id="Plot-Group-Level-Posterior-Distributions"><a class="docs-heading-anchor" href="#Plot-Group-Level-Posterior-Distributions">Plot Group-Level Posterior Distributions</a><a id="Plot-Group-Level-Posterior-Distributions-1"></a><a class="docs-heading-anchor-permalink" href="#Plot-Group-Level-Posterior-Distributions" title="Permalink"></a></h1><pre><code class="language-julia hljs">plot(group_chains)</code></pre><p><img src="../assets/hierarchical_posterior.png" alt/></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../plotting/">« Plotting</a><a class="docs-footer-nextpage" href="../api/">API »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Saturday 29 November 2025 10:13">Saturday 29 November 2025</span>. Using Julia version 1.11.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
